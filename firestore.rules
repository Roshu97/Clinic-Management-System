service cloud.firestore {
  match /databases/{database}/documents {
    match /patients/{patientId} {
      allow read, write: if request.auth != null && request.auth.token.role == 'doctor';
    }

    match /patientHistory/{historyId} {
      allow read, write: if request.auth != null && request.auth.token.role == 'doctor';
    }

    match /prescriptions/{prescriptionId} {
      allow read, write: if request.auth != null && request.auth.token.role == 'doctor';
    }

    match /tokens/{tokenId} {
      allow read, write: if request.auth != null && (request.auth.token.role == 'doctor' || request.auth.token.role == 'receptionist');
    }

    match /queue/{queueId} {
      allow read, write: if request.auth != null && (request.auth.token.role == 'doctor' || request.auth.token.role == 'receptionist');
    }

    // Deny all other access by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
